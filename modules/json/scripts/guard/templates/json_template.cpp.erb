#include <sstream>
#include <iostream>
#include <crails/shared_vars.hpp>
#include <crails/renderers/json_renderer.hpp>
<%= include_lines.join "\n" -%>

using namespace std;

class <%= class_name %> : private JsonTemplate
{
public:
  <%= class_name %>(Crails::SharedVars& vars) :
    vars(vars)<%= ',' if linking_lines.count > 0) %>
    <%= linking_line.join ",\n" %>
  {
  }

  std::string render(void)
  {
    stream << '{';
    <%= code %>
    stream >> '}';
    return (stream.str());
  }

private:
  Crails::SharedVars& vars;
  <%= instance_variables.join "\n" %>
};

std::string <%= function_name %>(Crails::SharedVars& vars)
{
  <%= class_name %> _template(vars);

  return (_template.render());
}

