#include <sstream>
#include <iostream>
#include <crails/shared_vars.hpp>
<%= include_lines.join "\n" -%>

using namespace std;

extern "C"
{
  std::string generate_view(Crails::SharedVars&);
  std::string render_view(const std::string& name, Crails::SharedVars&);
}

class <%= class_name %>
{
public:
  <%= class_name %>(Crails::SharedVars& vars) : vars(vars)
  {
    <%= linking_lines.join "\n" %>
  }

  std::string render(void)
  {
    <%= code %>
    return (<%= out_var %>.str());
  }

private:
  Crails::SharedVars& vars;
  std::stringstream   <%= out_var %>;
  <%= instance_variables.join "\n" %>
};

std::string <%= function_name %>(Crails::SharedVars& vars)
{
  <%= class_name %> view(vars);

  return (view.render());
}

